(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    142661,       2913]
NotebookOptionsPosition[    138060,       2780]
NotebookOutlinePosition[    139243,       2816]
CellTagsIndexPosition[    139200,       2813]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Bimetric computations in xAct 1", "Title",
 CellChangeTimes->{{3.6571762332776084`*^9, 3.6571762635416613`*^9}, {
  3.671619635859925*^9, 3.6716196365931263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "***********************************************************************)"}\
], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Bimetric", " ", "computations", " ", "in", " ", 
    RowBox[{"xAct", ".", " ", "Part"}], " ", 
    RowBox[{"I", "."}]}], "                               ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", " ", 
      RowBox[{"(", "c", ")"}], " ", "2014"}], "-", 
     RowBox[{"2015", " ", "by", " ", "Mikica", " ", 
      RowBox[{"B", ".", " ", "Kocic"}]}]}], ",", " ", 
    RowBox[{"under", " ", 
     RowBox[{"GPL", "."}]}]}], "               ", "*)"}], "\n", 
  RowBox[{
  "(*", "***********************************************************************)"}\
]}]], "Code",
 CellChangeTimes->{{3.6571762332776084`*^9, 3.6571763368773904`*^9}, {
  3.6571764660692177`*^9, 3.6571764794540405`*^9}, {3.657177790153545*^9, 
  3.6571777963935556`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", "\n", "  ", 
  RowBox[{
   RowBox[{
    RowBox[{"GNU", " ", "General", " ", "Public", " ", "License", " ", 
     RowBox[{"(", "GPL", ")"}], "\n", "\n", "  ", "This", " ", "program", " ",
      "is", " ", "free", " ", "software"}], ";", " ", 
    RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
     RowBox[{"and", "/", "or"}], " ", "modify", "\[IndentingNewLine]", "  ", 
     "it", " ", "under", " ", "the", " ", "terms", " ", "of", " ", "the", " ",
      "GNU", " ", "General", " ", "Public", " ", "License", " ", "as", " ", 
     "published", "\[IndentingNewLine]", "  ", "by", " ", "the", " ", "Free", 
     " ", "Software", " ", "Foundation"}], ";", " ", 
    RowBox[{
    "either", " ", "version", " ", "2", " ", "of", " ", "the", " ", 
     "License"}]}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"or", " ", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{
    "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
     "This"}], " ", "program", " ", "is", " ", "distributed", " ", "in", " ", 
    "the", " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
    "useful"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ", 
     "of", "\[IndentingNewLine]", "  ", "MERCHANTABILITY", " ", "or", " ", 
     "FITNESS", " ", "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", 
     "\[IndentingNewLine]", "  ", "General", " ", "Public", " ", "License", 
     " ", "for", " ", "more", " ", 
     RowBox[{
     "details", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
      "You"}], " ", "should", " ", "have", " ", "received", " ", "a", " ", 
     "copy", " ", "of", " ", "the", " ", "GNU", " ", "General", " ", "Public",
      " ", "License", "\[IndentingNewLine]", "  ", "along", " ", "with", " ", 
     "this", " ", "program"}], ";", " ", 
    RowBox[{"if", " ", "not"}]}], ",", " ", 
   RowBox[{
   "write", " ", "to", " ", "the", " ", "Free", " ", "Software", 
    "\[IndentingNewLine]", "  ", "Foundation"}], ",", " ", 
   RowBox[{"Inc", "."}], ",", " ", 
   RowBox[{
    RowBox[{"59", " ", "Temple", " ", "Place"}], "-", 
    RowBox[{"Suite", " ", "330"}]}], ",", " ", "Boston", ",", " ", 
   RowBox[{
    RowBox[{"MA", " ", "02111"}], "-", "1307"}], ",", "\[IndentingNewLine]", 
   "  ", 
   RowBox[{"USA", "."}]}], " ", "\[IndentingNewLine]", "*)"}]], "Code",
 CellChangeTimes->{{3.6571762332776084`*^9, 3.6571763368773904`*^9}, {
  3.6571764660692177`*^9, 3.6571765221981163`*^9}}],

Cell["Version 1.01 -- 2016-03-04 added Abs[] -> || in print nice", "Text",
 CellChangeTimes->{{3.697634252124462*^9, 3.6976342702584996`*^9}}],

Cell[CellGroupData[{

Cell["Setup the xAct system", "Subsubsection"],

Cell[BoxData[{
 RowBox[{"Print", "[", " ", 
  RowBox[{"StringRepeat", "[", " ", 
   RowBox[{"\"\<-\>\"", ",", " ", "60"}], " ", "]"}], " ", "]"}], "\n", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"Style", "[", " ", 
   RowBox[{
   "\"\<Loading xAct adapted to bimetric theory...\>\"", ",", " ", "Blue"}], 
   " ", "]"}], " ", "]"}], "\n", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"Style", "[", " ", 
   RowBox[{
   "\"\<Copyright (C) 2014-2015 by Mikica B. Kocic, under GPL.\>\"", ",", " ",
     "Blue"}], " ", "]"}], " ", "]"}]}], "Code",
 CellChangeTimes->{{3.657109885787877*^9, 3.6571098964426956`*^9}, {
   3.6571205156041484`*^9, 3.6571205741666517`*^9}, {3.6571272020646935`*^9, 
   3.657127320624902*^9}, 3.657131148952626*^9, {3.65713699156229*^9, 
   3.6571370158359327`*^9}, {3.657177038133823*^9, 3.6571770725006833`*^9}, {
   3.657177131000786*^9, 3.6571771349475927`*^9}, {3.6573498313933783`*^9, 
   3.6573498517046137`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xAct`Bim`prog$ind", " ", "=", " ", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"reset", " ", "progress", " ", "indicator"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"xAct`Bim`time$0", " ", "=", " ", 
   RowBox[{"SessionTime", " ", "[", "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"reset", " ", "session", " ", "time"}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.657109885787877*^9, 3.6571098988450994`*^9}, {
  3.6571370200011396`*^9, 3.657137021873143*^9}, {3.657137069890027*^9, 
  3.6571370707324286`*^9}, {3.671621488613779*^9, 3.6716215453510785`*^9}, {
  3.6716216382804418`*^9, 3.671621693660539*^9}, {3.671621725468995*^9, 
  3.6716217858411007`*^9}, {3.671621817056756*^9, 3.6716218215495634`*^9}, {
  3.6716218983328986`*^9, 3.671621909299718*^9}, {3.671621942917777*^9, 
  3.671621951996993*^9}, {3.671650560770301*^9, 3.6716505895211515`*^9}, {
  3.6717801270506353`*^9, 3.671780202842236*^9}, {3.6717806774756393`*^9, 
  3.671780681750039*^9}, {3.6717813718380437`*^9, 3.6717813724464436`*^9}, {
  3.6717827904308524`*^9, 3.671782801943652*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", " ", "[", " ", 
   RowBox[{
    RowBox[{"\[Not]", 
     RowBox[{"NumberQ", "[", "xAct`Bim`mem$0", "]"}]}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"xAct`Bim`mem$0", "  ", "=", " ", 
      RowBox[{"MemoryInUse", " ", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"xAct`Bim`cpu$0", "  ", "=", " ", 
      RowBox[{"TimeUsed", " ", "[", "]"}]}], ";", "\n", "\t", 
     RowBox[{"xAct`Bim`printerConf", " ", "=", " ", "1"}], ";", "\n", "\t", 
     RowBox[{"<<", " ", "xAct`ShowTime1`"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Utilities`ShowTime`$ShowTimeThreshold", " ", "=", " ", "5"}], 
     ";"}]}], "\n", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.657109885787877*^9, 3.6571098988450994`*^9}, {
  3.6571370200011396`*^9, 3.657137021873143*^9}, {3.657137069890027*^9, 
  3.6571370707324286`*^9}, {3.671621488613779*^9, 3.6716215453510785`*^9}, {
  3.6716216382804418`*^9, 3.671621693660539*^9}, {3.671621725468995*^9, 
  3.6716217858411007`*^9}, {3.671621817056756*^9, 3.6716218215495634`*^9}, {
  3.6716218983328986`*^9, 3.671621909299718*^9}, {3.671621942917777*^9, 
  3.671621951996993*^9}, {3.671650560770301*^9, 3.6716505895211515`*^9}, {
  3.6717801270506353`*^9, 3.671780202842236*^9}, {3.6717806774756393`*^9, 
  3.671780681750039*^9}, {3.6717813605124435`*^9, 3.6717813940368433`*^9}, {
  3.671782786952052*^9, 3.6717827884652524`*^9}}],

Cell["Load xAct...", "Text"],

Cell[BoxData[
 RowBox[{"BeginPackage", "[", " ", 
  RowBox[{"\"\<xAct`Bim`\>\"", ",", " ", 
   RowBox[{"{", " ", 
    RowBox[{"\"\<xAct`xCoba`\>\"", ",", " ", "\"\<xAct`TexAct`\>\""}], " ", 
    "}"}]}], "]"}]], "Code",
 CellChangeTimes->{{3.6716202170867453`*^9, 3.6716202460091963`*^9}, {
   3.6716205501317306`*^9, 3.6716205653105574`*^9}, {3.6716206657123337`*^9, 
   3.6716206672411366`*^9}, {3.671621109455113*^9, 3.6716211114519167`*^9}, {
   3.67162115329119*^9, 3.671621172541624*^9}, 3.671621203429678*^9, {
   3.671622108246867*^9, 3.6716221112576723`*^9}}],

Cell[TextData[{
 "Memory watchdog; forbid ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " of eating too much memory. Also: Launch all configured parallel subkernels."
}], "Text",
 CellChangeTimes->{{3.671619757306138*^9, 3.6716197588037405`*^9}, {
  3.671621961201009*^9, 3.671621961372609*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"memoryWatchdog", "[", " ", 
   RowBox[{"mb_", " ", ":", " ", "1.5"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"Quiet", "@", 
      RowBox[{
      "RemoveScheduledTask", "[", " ", "memory$watchdog", " ", "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"memory$watchdog", " ", "=", " ", 
      RowBox[{"RunScheduledTask", "[", " ", "\n", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], " ", ">", " ", 
           RowBox[{"mb", " ", 
            RowBox[{"1024", "^", "3"}]}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Max", " ", "1.5", " ", "GB"}], " ", "*)"}], ",", " ", 
          RowBox[{"Quit", "[", "]"}]}], " ", "]"}], ",", " ", "\n", "\t\t", 
        "1"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"every", " ", "1", " ", "sec"}], " ", "*)"}], " ", "\n", "\t",
        "]"}]}], ";", "\n", "\t", 
     RowBox[{"Quiet", "@", 
      RowBox[{"LaunchKernels", " ", "[", "]"}]}], ";"}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.657109885787877*^9, 3.6571098988450994`*^9}, {
   3.657137025258349*^9, 3.6571370613100123`*^9}, 3.657137096831275*^9, {
   3.6716195252713304`*^9, 3.6716195754722185`*^9}, {3.6716197358249006`*^9, 
   3.6716197364177012`*^9}, {3.6716198978945847`*^9, 
   3.6716199459738693`*^9}, {3.671620035798827*^9, 3.671620036844029*^9}, {
   3.6716212300277247`*^9, 3.671621265158986*^9}, {3.671621302957853*^9, 
   3.671621330975502*^9}, {3.6716213618947563`*^9, 3.6716213971352186`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xAct`xTensor`$Info", " ", "=", " ", "False"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Deactivate", " ", "info", " ", "messages", " ", "in", " ", "xTensor"}], 
   " ", "*)"}]}]], "Code",
 CellChangeTimes->{{3.6571099460507827`*^9, 3.657109946877584*^9}, {
  3.6716206375698843`*^9, 3.671620639863088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xAct`xCoba`$CVVerbose", " ", "=", " ", "False"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Deactivate", " ", "info", " ", "messages", " ", "in", " ", "xCoba"}], " ",
    "*)"}]}]], "Code",
 CellChangeTimes->{{3.6558849820181932`*^9, 3.6558849843893976`*^9}, {
   3.6571099476419854`*^9, 3.6571099489679875`*^9}, 3.6716206428426933`*^9, {
   3.6716207106092124`*^9, 3.6716207112956133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PrePrint", " ", "=", " ", "xAct`xTensor`ScreenDollarIndices"}], 
  ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Hide", " ", "away", " ", "ugly", " ", "dummies"}], " ", 
   "*)"}]}]], "Code",
 CellChangeTimes->{{3.657110000307678*^9, 3.657110001087679*^9}, 
   3.6716207424176683`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Display the context and the used resources", "Subsubsection",
 CellChangeTimes->{{3.655885099502*^9, 3.6558851041040077`*^9}, {
  3.655885223210217*^9, 3.655885225300621*^9}, {3.6571100307745314`*^9, 
  3.657110045329357*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mem$1", " ", "=", " ", 
   RowBox[{"MemoryInUse", " ", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpu$1", " ", "=", " ", 
   RowBox[{"TimeUsed", " ", "[", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.657109885787877*^9, 3.6571098988450994`*^9}, {
  3.6571370200011396`*^9, 3.657137021873143*^9}, {3.657137069890027*^9, 
  3.6571370707324286`*^9}, {3.657350013960499*^9, 3.6573500143504996`*^9}, {
  3.657350218283058*^9, 3.6573502521819177`*^9}}],

Cell[BoxData[{
 RowBox[{"Print", "[", " ", 
  RowBox[{"\"\<Context path: \>\"", ",", " ", 
   RowBox[{"Style", "[", " ", 
    RowBox[{"$ContextPath", ",", " ", "Blue"}], " ", "]"}]}], " ", 
  "]"}], "\n", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"\"\<Memory in use: \>\"", ",", " ", 
   RowBox[{"Style", "[", " ", 
    RowBox[{
     RowBox[{"mem$1", " ", "-", " ", "mem$0"}], ",", " ", "Blue"}], " ", 
    "]"}]}], " ", "]"}], "\n", 
 RowBox[{"Print", "[", " ", 
  RowBox[{"\"\<Time used: \>\"", ",", " ", 
   RowBox[{"Style", "[", " ", 
    RowBox[{
     RowBox[{"cpu$1", " ", "-", " ", "cpu$0"}], ",", " ", "Blue"}], " ", 
    "]"}]}], " ", "]"}], "\n", 
 RowBox[{"Print", "[", " ", "xAct`xCore`Private`bars", " ", "]"}]}], "Code",
 CellChangeTimes->{{3.657109971993628*^9, 3.6571099743960323`*^9}, {
   3.6571167960841055`*^9, 3.6571168266757593`*^9}, {3.6571168628178225`*^9, 
   3.6571168768266473`*^9}, {3.6571175412630143`*^9, 3.657117552510634*^9}, 
   3.6571205322337775`*^9, 3.657131155099037*^9, 3.6571370927596674`*^9, {
   3.6571771233723726`*^9, 3.6571771235595727`*^9}, {3.657349863576235*^9, 
   3.657349926927946*^9}, {3.657350238266693*^9, 3.6573502574079266`*^9}, {
   3.6714475348323784`*^9, 3.6714475550225334`*^9}, {3.6716215953179665`*^9, 
   3.6716216227272143`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nicely print the fields", "Subsection",
 CellChangeTimes->{{3.6558823261291285`*^9, 3.6558823336171417`*^9}, {
  3.655884616431551*^9, 3.6558846665700393`*^9}, {3.6570311739322453`*^9, 
  3.657031235411953*^9}, {3.6571373334836903`*^9, 3.6571373377580976`*^9}}],

Cell[TextData[{
 "These rely on the user\[CloseCurlyQuote]s function ",
 StyleBox["printNice",
  FontFamily->"Courier New"],
 " that should print scalar fields and their derivatives nicely (devoid of \
coordinate fields)."
}], "Text",
 CellChangeTimes->{{3.6571261043365655`*^9, 3.657126129093809*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"redefineFields", "[", " ", "expr_", " ", "]"}], " ", ":=", " ", 
    "expr"}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{"called", " ", "each", " ", "time", " ", "after", " ", 
    RowBox[{"ToValues", "[", "]"}]}], " ", "*)"}]}]], "Code",
 CellChangeTimes->{{3.67144125285107*^9, 3.6714412855859423`*^9}, {
   3.6714413370748873`*^9, 3.671441414306305*^9}, {3.6714428645842557`*^9, 
   3.671442911231924*^9}, 3.671446160243757*^9, {3.6716899351667633`*^9, 
   3.671689963044012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myPrint", " ", "=", " ", "writeExpr"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"default", " ", "'"}], 
    RowBox[{"printer", "'"}]}], " ", "*)"}]}]], "Code",
 CellChangeTimes->{{3.6558812697108727`*^9, 3.655881346665808*^9}, {
   3.655881681910397*^9, 3.655881692346815*^9}, {3.655882510973853*^9, 
   3.655882526776681*^9}, {3.655889702311284*^9, 3.6558897109068995`*^9}, 
   3.655890094090372*^9, {3.6558908153600407`*^9, 3.6558908172632437`*^9}, {
   3.6558908962617826`*^9, 3.6558909193030233`*^9}, {3.655890952219081*^9, 
   3.655891099140139*^9}, {3.655891240731345*^9, 3.655891293506238*^9}, {
   3.6558917577474537`*^9, 3.655891779228691*^9}, {3.655901776643852*^9, 
   3.6559017958318853`*^9}, {3.6559018640820055`*^9, 3.655901877357629*^9}, {
   3.655901920132904*^9, 3.65590195791617*^9}, {3.656952151849202*^9, 
   3.6569521527696037`*^9}, {3.656952254200982*^9, 3.6569523600159683`*^9}, {
   3.6569526561512885`*^9, 3.656952696508559*^9}, {3.6569527374742312`*^9, 
   3.6569527747436967`*^9}, {3.656952813697965*^9, 3.656952825210785*^9}, {
   3.6570311069457273`*^9, 3.6570311126553373`*^9}, {3.657114811139819*^9, 
   3.6571148206090355`*^9}, {3.6571192227275677`*^9, 3.657119225317172*^9}, {
   3.6571192571412277`*^9, 3.657119259496832*^9}, {3.657121623377694*^9, 
   3.657121627761302*^9}, {3.6571216706301775`*^9, 3.65712167214338*^9}, {
   3.657121723030669*^9, 3.657121726587476*^9}, {3.657124767148017*^9, 
   3.6571248263657207`*^9}, {3.6571248733530035`*^9, 3.657124873680604*^9}, 
   3.657125232965835*^9, {3.6571252722779045`*^9, 3.65712529823635*^9}, {
   3.6571253423532276`*^9, 3.6571253570640535`*^9}, {3.6571255042191114`*^9, 
   3.6571255360431676`*^9}, {3.657125740450327*^9, 3.657125745785536*^9}, {
   3.657127618508425*^9, 3.6571276242648354`*^9}, {3.657127845488824*^9, 
   3.6571279290893707`*^9}, {3.6571280043283033`*^9, 3.657128064045208*^9}, {
   3.6571282033846526`*^9, 3.6571283437692995`*^9}, {3.6571283747041535`*^9, 
   3.6571283995549974`*^9}, {3.657128439506667*^9, 3.6571285096911907`*^9}, {
   3.657128602308553*^9, 3.657128706360736*^9}, {3.6571390240742598`*^9, 
   3.657139037911484*^9}, {3.6571391305912466`*^9, 3.6571391502940817`*^9}, {
   3.6571393019731483`*^9, 3.657139304203952*^9}, 3.6571394902654786`*^9, {
   3.657139750692336*^9, 3.6571397794587865`*^9}, {3.65713986688134*^9, 
   3.657139868098142*^9}, 3.6571399049142065`*^9, 3.6571400632856855`*^9, {
   3.657140132019406*^9, 3.657140151909441*^9}, {3.657140248832411*^9, 
   3.6571402547760215`*^9}, {3.657140298924099*^9, 3.657140331138156*^9}, {
   3.6571403741474314`*^9, 3.6571404181083083`*^9}, {3.657140537932119*^9, 
   3.657140559444556*^9}, {3.657140669130749*^9, 3.6571406922343903`*^9}, {
   3.657140734401264*^9, 3.6571407368972683`*^9}, {3.657178461727124*^9, 
   3.6571784617427244`*^9}, {3.657346925626629*^9, 3.6573469292458353`*^9}, {
   3.6573474813828163`*^9, 3.6573474825996184`*^9}, {3.6573475546373463`*^9, 
   3.657347563406562*^9}, {3.657347614348652*^9, 3.657347834825443*^9}, {
   3.6573478857815337`*^9, 3.6573478959683514`*^9}, {3.671447496474185*^9, 
   3.6714475158862953`*^9}, {3.6716899652904167`*^9, 
   3.6716899701576247`*^9}, {3.6717816751966457`*^9, 3.671781676382245*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sc\[CapitalPhi]$pn", "[", " ", 
   RowBox[{"p_", ",", " ", 
    RowBox[{"q_:", "0"}], ",", " ", 
    RowBox[{"r_:", "0"}], ",", " ", 
    RowBox[{"s_:", "0"}]}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Style", "[", " ", 
   RowBox[{
    RowBox[{"\"\<,\>\"", "\n", "\t", "<>", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"p", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]",
          " ", "0"}]}], ",", " ", "\"\<\>\"", ",", " ", 
       RowBox[{"StringRepeat", "[", " ", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "1", "\[RightDoubleBracket]"}], "]"}], "]"}], ",", " ", "p"}], 
        " ", "]"}]}], " ", "]"}], "\n", "\t", "<>", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"q", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]",
          " ", "1"}]}], ",", " ", "\"\<\>\"", ",", " ", 
       RowBox[{"StringRepeat", "[", " ", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "]"}], "]"}], ",", " ", "q"}], 
        " ", "]"}]}], " ", "]"}], "\n", "\t", "<>", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"r", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]",
          " ", "2"}]}], ",", " ", "\"\<\>\"", ",", " ", 
       RowBox[{"StringRepeat", "[", " ", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "3", "\[RightDoubleBracket]"}], "]"}], "]"}], ",", " ", "r"}], 
        " ", "]"}]}], " ", "]"}], "\n", "\t", "<>", " ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"s", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]",
          " ", "3"}]}], ",", " ", "\"\<\>\"", ",", " ", 
       RowBox[{"StringRepeat", "[", " ", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "4", "\[RightDoubleBracket]"}], "]"}], "]"}], ",", " ", "s"}], 
        " ", "]"}]}], " ", "]"}]}], ",", "\n", "\t", "Red"}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.6558812697108727`*^9, 3.655881346665808*^9}, {
   3.655881681910397*^9, 3.655881692346815*^9}, {3.655882510973853*^9, 
   3.655882526776681*^9}, {3.655889702311284*^9, 3.6558897109068995`*^9}, 
   3.655890094090372*^9, {3.6558908153600407`*^9, 3.6558908172632437`*^9}, {
   3.6558908962617826`*^9, 3.6558909193030233`*^9}, {3.655890952219081*^9, 
   3.655891099140139*^9}, {3.655891240731345*^9, 3.655891293506238*^9}, {
   3.6558917577474537`*^9, 3.655891779228691*^9}, {3.655901776643852*^9, 
   3.6559017958318853`*^9}, {3.6559018640820055`*^9, 3.655901877357629*^9}, {
   3.655901920132904*^9, 3.65590195791617*^9}, {3.656952151849202*^9, 
   3.6569521527696037`*^9}, {3.656952254200982*^9, 3.6569523600159683`*^9}, {
   3.6569526561512885`*^9, 3.656952696508559*^9}, {3.6569527374742312`*^9, 
   3.6569527747436967`*^9}, {3.656952813697965*^9, 3.656952825210785*^9}, {
   3.6570311069457273`*^9, 3.6570311126553373`*^9}, {3.657114811139819*^9, 
   3.6571148206090355`*^9}, {3.6571192227275677`*^9, 3.657119225317172*^9}, {
   3.6571192571412277`*^9, 3.657119259496832*^9}, {3.657121623377694*^9, 
   3.657121627761302*^9}, {3.6571216706301775`*^9, 3.65712167214338*^9}, {
   3.657121723030669*^9, 3.657121726587476*^9}, {3.657124767148017*^9, 
   3.6571248263657207`*^9}, {3.6571248733530035`*^9, 3.657124873680604*^9}, 
   3.657125232965835*^9, {3.6571252722779045`*^9, 3.65712529823635*^9}, {
   3.6571253423532276`*^9, 3.6571253570640535`*^9}, {3.6571255042191114`*^9, 
   3.6571255360431676`*^9}, {3.657125740450327*^9, 3.657125745785536*^9}, {
   3.657127618508425*^9, 3.6571276242648354`*^9}, {3.657127845488824*^9, 
   3.6571279290893707`*^9}, {3.6571280043283033`*^9, 3.657128064045208*^9}, {
   3.6571282033846526`*^9, 3.6571283437692995`*^9}, {3.6571283747041535`*^9, 
   3.6571283995549974`*^9}, {3.657128439506667*^9, 3.6571285096911907`*^9}, {
   3.657128602308553*^9, 3.657128706360736*^9}, {3.6571390240742598`*^9, 
   3.657139037911484*^9}, {3.6571391305912466`*^9, 3.6571391502940817`*^9}, {
   3.6571393019731483`*^9, 3.657139304203952*^9}, 3.6571394902654786`*^9, {
   3.657139750692336*^9, 3.6571397794587865`*^9}, {3.65713986688134*^9, 
   3.657139868098142*^9}, 3.6571399049142065`*^9, 3.6571400632856855`*^9, {
   3.657140132019406*^9, 3.657140151909441*^9}, {3.657140248832411*^9, 
   3.6571402547760215`*^9}, {3.657140298924099*^9, 3.657140331138156*^9}, {
   3.6571403741474314`*^9, 3.6571404181083083`*^9}, {3.657140537932119*^9, 
   3.657140559444556*^9}, {3.657140669130749*^9, 3.6571406922343903`*^9}, {
   3.657140734401264*^9, 3.6571407368972683`*^9}, {3.657178461727124*^9, 
   3.6571784617427244`*^9}, {3.657346925626629*^9, 3.6573469292458353`*^9}, {
   3.6573474813828163`*^9, 3.6573474825996184`*^9}, {3.6573475546373463`*^9, 
   3.657347563406562*^9}, {3.657347614348652*^9, 3.657347834825443*^9}, {
   3.6573478857815337`*^9, 3.6573478959683514`*^9}, {3.671447496474185*^9, 
   3.6714474979352684`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"printNice", "[", " ", "expr_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"expr", " ", "/.", " ", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "2", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "Scalars\[ScriptCapitalB]", "}"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}], "]"}],
       " ", "\[RuleDelayed]", " ", 
      RowBox[{"Style", "[", 
       RowBox[{
        OverscriptBox["a", 
         "\"\<\[CenterDot]\[NegativeMediumSpace]\[CenterDot]\>\""], ",", 
        "Red"}], "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "2", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "Scalars\[ScriptCapitalB]", "}"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}], "]"}],
       " ", "\[RuleDelayed]", " ", 
      RowBox[{"Style", "[", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], ",", "Red"}], "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "Scalars\[ScriptCapitalB]", "}"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}], "]"}],
       " ", "\[RuleDelayed]", " ", 
      RowBox[{"Style", "[", 
       RowBox[{
        OverscriptBox["a", "\"\<\[CenterDot]\>\""], ",", "Blue"}], "]"}]}], 
     ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "Scalars\[ScriptCapitalB]", "}"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}], "]"}],
       " ", "\[RuleDelayed]", " ", 
      RowBox[{"Style", "[", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], ",", "Blue"}], "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"p_", ",", "q_", ",", "r_", ",", "s_"}], "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       "\[CapitalPhi]ield", "]"}], " ", "\[RuleDelayed]", " ", 
      SubscriptBox["a", 
       RowBox[{"sc\[CapitalPhi]$pn", "[", 
        RowBox[{"p", ",", "q", ",", "r", ",", "s"}], "]"}]]}], ",", "\n", 
     "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"p_", ",", "q_", ",", "r_"}], "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       "\[CapitalPhi]ield", "]"}], " ", "\[RuleDelayed]", " ", 
      SubscriptBox["a", 
       RowBox[{"sc\[CapitalPhi]$pn", "[", 
        RowBox[{"p", ",", "q", ",", "r"}], "]"}]]}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"p_", ",", "q_"}], "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       "\[CapitalPhi]ield", "]"}], " ", "\[RuleDelayed]", " ", 
      SubscriptBox["a", 
       RowBox[{"sc\[CapitalPhi]$pn", "[", 
        RowBox[{"p", ",", "q"}], "]"}]]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "[", "any__", "]"}], " ", 
      "\[RuleDelayed]", " ", "a"}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Code",
 CellChangeTimes->{{3.6558812697108727`*^9, 3.655881346665808*^9}, {
   3.655881681910397*^9, 3.655881692346815*^9}, {3.655882510973853*^9, 
   3.655882526776681*^9}, {3.655889702311284*^9, 3.6558897109068995`*^9}, 
   3.655890094090372*^9, {3.6558908153600407`*^9, 3.6558908172632437`*^9}, {
   3.6558908962617826`*^9, 3.6558909193030233`*^9}, {3.655890952219081*^9, 
   3.655891099140139*^9}, {3.655891240731345*^9, 3.655891293506238*^9}, {
   3.6558917577474537`*^9, 3.655891779228691*^9}, {3.655901776643852*^9, 
   3.6559017958318853`*^9}, {3.6559018640820055`*^9, 3.655901877357629*^9}, {
   3.655901920132904*^9, 3.65590195791617*^9}, {3.656952151849202*^9, 
   3.6569521527696037`*^9}, {3.656952254200982*^9, 3.6569523600159683`*^9}, {
   3.6569526561512885`*^9, 3.656952696508559*^9}, {3.6569527374742312`*^9, 
   3.6569527747436967`*^9}, {3.656952813697965*^9, 3.656952825210785*^9}, {
   3.6570311069457273`*^9, 3.6570311126553373`*^9}, {3.657114811139819*^9, 
   3.6571148206090355`*^9}, {3.6571192227275677`*^9, 3.657119225317172*^9}, {
   3.6571192571412277`*^9, 3.657119259496832*^9}, {3.657121623377694*^9, 
   3.657121627761302*^9}, {3.6571216706301775`*^9, 3.65712167214338*^9}, {
   3.657121723030669*^9, 3.657121726587476*^9}, {3.657124767148017*^9, 
   3.6571248263657207`*^9}, {3.6571248733530035`*^9, 3.657124873680604*^9}, 
   3.657125232965835*^9, {3.6571252722779045`*^9, 3.65712529823635*^9}, {
   3.6571253423532276`*^9, 3.6571253570640535`*^9}, {3.6571255042191114`*^9, 
   3.6571255360431676`*^9}, {3.657125740450327*^9, 3.657125745785536*^9}, {
   3.657127618508425*^9, 3.6571276242648354`*^9}, {3.657127845488824*^9, 
   3.6571279290893707`*^9}, {3.6571280043283033`*^9, 3.657128064045208*^9}, {
   3.6571282033846526`*^9, 3.6571283437692995`*^9}, {3.6571283747041535`*^9, 
   3.6571283995549974`*^9}, {3.657128439506667*^9, 3.6571285096911907`*^9}, {
   3.657128602308553*^9, 3.657128706360736*^9}, {3.6571390240742598`*^9, 
   3.657139037911484*^9}, {3.6571391305912466`*^9, 3.6571391502940817`*^9}, {
   3.6571393019731483`*^9, 3.657139304203952*^9}, 3.6571394902654786`*^9, {
   3.657139750692336*^9, 3.6571397794587865`*^9}, {3.65713986688134*^9, 
   3.657139868098142*^9}, 3.6571399049142065`*^9, 3.6571400632856855`*^9, {
   3.657140132019406*^9, 3.657140151909441*^9}, {3.657140248832411*^9, 
   3.6571402547760215`*^9}, {3.657140298924099*^9, 3.657140331138156*^9}, {
   3.6571403741474314`*^9, 3.6571404181083083`*^9}, {3.657140537932119*^9, 
   3.657140559444556*^9}, {3.657140669130749*^9, 3.6571406922343903`*^9}, {
   3.657140734401264*^9, 3.6571407368972683`*^9}, {3.657178461727124*^9, 
   3.6571784617427244`*^9}, {3.657346925626629*^9, 3.6573469292458353`*^9}, {
   3.6573474813828163`*^9, 3.657347608853442*^9}, {3.6720604713163557`*^9, 
   3.672060480660772*^9}, {3.672060966376507*^9, 3.672060972944118*^9}, {
   3.6720663468153796`*^9, 3.6720663502629857`*^9}, {3.6720670933234906`*^9, 
   3.6720670946806927`*^9}, {3.6720676228362207`*^9, 
   3.6720676242090235`*^9}, {3.672067845620212*^9, 3.672067846790214*^9}, {
   3.672068085954234*^9, 3.6720681060782695`*^9}, {3.6720684828643208`*^9, 
   3.672068484190323*^9}, {3.6720685444376287`*^9, 3.672068560770858*^9}, {
   3.672077124327901*^9, 3.67207712952271*^9}, {3.697634222598774*^9, 
   3.697634229830187*^9}, {3.699966522496478*^9, 3.699966531279294*^9}, {
   3.7065254836490197`*^9, 3.7065255026030197`*^9}, 3.70652583605602*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printComponents", "[", " ", 
    RowBox[{"B_", ",", " ", "func_"}], " ", "]"}], "[", " ", "e_", " ", "]"}],
   " ", ":=", " ", 
  RowBox[{"myPrint", "[", "\n", 
   RowBox[{"Row", "@", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{"e", ",", " ", "\"\< \[DotEqual] \>\"", ",", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"e", " ", "//", " ", 
                 RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
                RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
               "TraceBasisDummy"}], " ", "//", " ", "ComponentArray"}], " ", "//",
              " ", "ToValues"}], " ", "//", " ", "ToValues"}], " ", "//", " ",
            "redefineFields"}], " ", "//", " ", "Simplify"}], "\n", "\t  ", "//",
          " ", "printNice"}], " ", "//", " ", "Simplify"}], " ", "//", " ", 
       "func"}]}], "\n", "}"}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.6558835874381437`*^9, 3.6558839123555145`*^9}, {
   3.655883959405197*^9, 3.655884022008107*^9}, {3.655884258130122*^9, 
   3.6558842595341244`*^9}, {3.6558863149141345`*^9, 
   3.6558863512933984`*^9}, {3.655886385722659*^9, 3.6558863862062597`*^9}, {
   3.655894145781448*^9, 3.6558941528014603`*^9}, {3.6559164962776904`*^9, 
   3.6559165463537784`*^9}, {3.6559166601715784`*^9, 
   3.6559166636971846`*^9}, {3.655916711620469*^9, 3.6559167134612722`*^9}, 
   3.6559168058214345`*^9, {3.6559173617284107`*^9, 3.6559173637096143`*^9}, {
   3.6559175382895207`*^9, 3.6559175511595435`*^9}, {3.6559176042776365`*^9, 
   3.6559176230132694`*^9}, {3.657119234614788*^9, 3.6571192364555917`*^9}, {
   3.6571261480946426`*^9, 3.657126217623965*^9}, 3.657131058363267*^9, {
   3.657137869048231*^9, 3.6571378692510314`*^9}, {3.671447556896641*^9, 
   3.6714475576946864`*^9}, 3.671689876916261*^9, {3.69997683928087*^9, 
   3.699976844441165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printComponents", "[", " ", "B_", " ", "]"}], "[", " ", "e_", " ",
    "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"printComponents", "[", " ", 
    RowBox[{"B", ",", " ", 
     RowBox[{"#", "&"}]}], " ", "]"}], "[", " ", "e", " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.6558835874381437`*^9, 3.6558839123555145`*^9}, {
   3.655883959405197*^9, 3.655884022008107*^9}, {3.655884258130122*^9, 
   3.6558842595341244`*^9}, {3.6558863149141345`*^9, 
   3.6558863512933984`*^9}, {3.655886385722659*^9, 3.6558863862062597`*^9}, {
   3.655894145781448*^9, 3.6558941528014603`*^9}, {3.6559164962776904`*^9, 
   3.6559165463537784`*^9}, {3.6559166601715784`*^9, 
   3.6559166636971846`*^9}, {3.655916711620469*^9, 3.6559167134612722`*^9}, 
   3.6559168058214345`*^9, {3.6559173617284107`*^9, 3.6559173637096143`*^9}, {
   3.655917564076366*^9, 3.6559175767123885`*^9}, {3.655917607475642*^9, 
   3.655917618005661*^9}, {3.6571262220387726`*^9, 3.657126230868388*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printMatrixComponents", "[", " ", "B_", " ", "]"}], "[", " ", 
   "e_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"myPrint", "[", "\[IndentingNewLine]", 
   RowBox[{"Row", "@", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{
      RowBox[{"e", " ", "//", " ", 
       RowBox[{"ToBasis", "[", "B", "]"}]}], ",", " ", "\"\< = \>\"", ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"e", " ", "//", " ", 
                  RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
                 RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
                "xAct`xTensor`ScreenDollarIndices"}], " ", "//", " ", 
               "ComponentArray"}], " ", "//", " ", "ToValues"}], " ", "//", 
             " ", "ToValues"}], " ", "//", " ", "redefineFields"}], " ", "//",
            " ", "Simplify"}], "\n", "\t  ", "//", " ", "printNice"}], " ", "//",
          " ", "Simplify"}], " ", "//", " ", "Expand"}], " ", "//", " ", 
       "MatrixForm"}]}], "\n", "}"}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.6558835874381437`*^9, 3.6558839123555145`*^9}, {
   3.655883959405197*^9, 3.655884022008107*^9}, {3.655884258130122*^9, 
   3.6558842595341244`*^9}, {3.6558863149141345`*^9, 
   3.6558863512933984`*^9}, {3.655886385722659*^9, 3.6558863862062597`*^9}, {
   3.6558871124031353`*^9, 3.655887148532799*^9}, {3.655887184506462*^9, 
   3.6558872139437137`*^9}, {3.655894088279747*^9, 3.655894093396556*^9}, {
   3.6558941375914335`*^9, 3.6558941435194435`*^9}, 3.6559167838173957`*^9, {
   3.6571192697772503`*^9, 3.6571192709472523`*^9}, {3.657126233348792*^9, 
   3.6571262894474907`*^9}, 3.6571265477527447`*^9, {3.6571310413280373`*^9, 
   3.6571310488472505`*^9}, {3.6571378727298374`*^9, 3.657137873057438*^9}, {
   3.67144755845473*^9, 3.671447559246775*^9}, {3.671449406211506*^9, 
   3.6714494070071077`*^9}, 3.6716209948729115`*^9, 3.6716898800674667`*^9, 
   3.699976849120433*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printNonZeroComponents", "[", " ", 
    RowBox[{"B_", ",", " ", "func_"}], " ", "]"}], "[", " ", "e_", " ", "]"}],
   " ", ":=", " ", 
  RowBox[{"(", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"myPrint", "[", "#", "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"(", "\n", "\t", 
      RowBox[{"Row", " ", "/@", " ", 
       RowBox[{"(", "\n", "\t\t", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t", 
             RowBox[{
             "#1", ",", " ", "\"\< \[DotEqual] \>\"", ",", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", " ", "//", " ", "TraceBasisDummy"}], " ", "//",
                     " ", "ComponentArray"}], " ", "//", " ", "ToValues"}], 
                    " ", "//", " ", "ToValues"}], " ", "//", " ", 
                   "redefineFields"}], " ", "//", " ", "Simplify"}], "\n", 
                 "\t\t\t\t   ", "//", " ", "printNice"}], " ", "//", " ", 
                "Simplify"}], " ", "//", " ", "func"}]}], "\n", "\t\t\t", 
             "}"}], "&"}], " ", "/@", " ", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"e", " ", "//", " ", 
                 RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
                RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
               "xAct`xTensor`ScreenDollarIndices"}], " ", "//", " ", 
              "ComponentArray"}], " ", "//", " ", "Flatten"}], " ", ")"}]}], 
          "\[IndentingNewLine]", "\t\t", ")"}], " ", "//", " ", 
         RowBox[{
          RowBox[{"Select", "[", " ", 
           RowBox[{"#1", ",", " ", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               SubscriptBox["#1", 
                RowBox[{"[", 
                 RowBox[{"[", "3", "]"}], "]"}]], " ", "=!=", " ", "0"}], " ",
               ")"}], "&"}]}], " ", "]"}], "&"}]}], "\[IndentingNewLine]", 
        "\t", ")"}]}], "\n", ")"}]}], ";"}], ")"}]}]], "Code",
 CellChangeTimes->{{3.6558835874381437`*^9, 3.6558839123555145`*^9}, {
   3.655883959405197*^9, 3.655884022008107*^9}, {3.655884258130122*^9, 
   3.6558842595341244`*^9}, {3.6558863149141345`*^9, 
   3.6558863512933984`*^9}, {3.655886385722659*^9, 3.6558863862062597`*^9}, {
   3.6558871124031353`*^9, 3.655887148532799*^9}, {3.655887184506462*^9, 
   3.6558872139437137`*^9}, {3.655894088279747*^9, 3.655894093396556*^9}, {
   3.6558941375914335`*^9, 3.6558941435194435`*^9}, {3.6559157199579268`*^9, 
   3.6559157318919477`*^9}, {3.6559158182848997`*^9, 
   3.6559158267713146`*^9}, {3.6559160106020374`*^9, 3.655916045873699*^9}, {
   3.655916089460176*^9, 3.6559160927673817`*^9}, {3.655916129848647*^9, 
   3.655916150269083*^9}, {3.6559169851125493`*^9, 3.655916994098165*^9}, 
   3.655917051443866*^9, {3.6559170838295226`*^9, 3.6559171048115597`*^9}, {
   3.655917149536838*^9, 3.6559171963993206`*^9}, {3.6571262954223013`*^9, 
   3.657126485337035*^9}, {3.6571310363828287`*^9, 3.6571310680508842`*^9}, {
   3.6571378818090534`*^9, 3.657137882043054*^9}, 3.6711917086354523`*^9, {
   3.6714475599588156`*^9, 3.6714475627509756`*^9}, {3.671449389238676*^9, 
   3.6714493926550827`*^9}, 3.671620998195718*^9, 3.6716898827818713`*^9, {
   3.699976852432622*^9, 3.6999768573129015`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printNonZeroComponents", "[", " ", "B_", " ", "]"}], "[", " ", 
   "e_", " ", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"printNonZeroComponents", "[", " ", 
    RowBox[{"B", ",", " ", 
     RowBox[{"#", "&"}]}], " ", "]"}], "[", " ", "e", " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.6558835874381437`*^9, 3.6558839123555145`*^9}, {
   3.655883959405197*^9, 3.655884022008107*^9}, {3.655884258130122*^9, 
   3.6558842595341244`*^9}, {3.6558863149141345`*^9, 
   3.6558863512933984`*^9}, {3.655886385722659*^9, 3.6558863862062597`*^9}, {
   3.6558871124031353`*^9, 3.655887148532799*^9}, {3.655887184506462*^9, 
   3.6558872139437137`*^9}, {3.655894088279747*^9, 3.655894093396556*^9}, {
   3.6558941375914335`*^9, 3.6558941435194435`*^9}, {3.6559157199579268`*^9, 
   3.6559157318919477`*^9}, {3.6559158182848997`*^9, 
   3.6559158267713146`*^9}, {3.6559160106020374`*^9, 3.655916045873699*^9}, {
   3.655916089460176*^9, 3.6559160927673817`*^9}, {3.655916129848647*^9, 
   3.655916150269083*^9}, {3.6559169851125493`*^9, 3.655916994098165*^9}, 
   3.655917051443866*^9, {3.6559170838295226`*^9, 3.6559171048115597`*^9}, {
   3.655917149536838*^9, 3.6559172705462503`*^9}, {3.65712644841177*^9, 
   3.6571264572257853`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Nicely print the fields in ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.6558823261291285`*^9, 3.6558823336171417`*^9}, {
  3.655884616431551*^9, 3.6558846665700393`*^9}, {3.6570311739322453`*^9, 
  3.657031235411953*^9}, {3.6571373334836903`*^9, 3.6571373377580976`*^9}, {
  3.671618937040097*^9, 3.671618940768504*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"Power", "[", " ", 
    RowBox[{
     RowBox[{"sDot", "[", "x_", "]"}], ",", " ", "n_"}], " ", "]"}], " ", 
   "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{blue}\\\\dot{\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", "\"\<}^{\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "n"}], " ", "<>", " ", "\"\<}}\>\""}]}], "\n", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"Power", "[", " ", 
    RowBox[{
     RowBox[{"dDot", "[", "x_", "]"}], ",", " ", "n_"}], " ", "]"}], " ", 
   "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{red}\\\\ddot{\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", "\"\<}^{\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "n"}], " ", "<>", " ", "\"\<}}\>\""}]}], "\n", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"Power", "[", " ", 
    RowBox[{
     RowBox[{"sPrime", "[", "x_", "]"}], ",", " ", "n_"}], " ", "]"}], " ", 
   "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{blue}\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", "\"\<^{\\\\prime\\\\,\>\"", " ",
    "<>", " ", 
   RowBox[{"Tex", "@", "n"}], " ", "<>", " ", "\"\<}}\>\""}]}], "\n", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"Power", "[", " ", 
    RowBox[{
     RowBox[{"dPrime", "[", "x_", "]"}], ",", " ", "n_"}], " ", "]"}], " ", 
   "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{red}\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", 
   "\"\<^{\\\\prime\\\\prime\\\\,\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "n"}], " ", "<>", " ", "\"\<}}\>\""}]}]}], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.671619245359039*^9}, 3.6716192890859156`*^9, {
   3.6716230029556026`*^9, 3.6716230047028055`*^9}, {3.6716230382691417`*^9, 
   3.671623059643364*^9}, {3.67162344045519*^9, 3.6716234473504024`*^9}, {
   3.6716234949304857`*^9, 3.671623506802107*^9}, {3.671623549764582*^9, 
   3.671623555208992*^9}, {3.6716236774040065`*^9, 3.671623677762807*^9}, {
   3.6716389772201567`*^9, 3.671639000947798*^9}, {3.6716404143570805`*^9, 
   3.671640418569088*^9}, {3.671690466191696*^9, 3.671690529715008*^9}, {
   3.6716906389775996`*^9, 3.671690674701662*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"sDot", "[", "x_", "]"}], "   ", "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{blue}\\\\dot{\>\"", "  ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", 
   "\"\<}}\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"dDot", "[", "x_", "]"}], "   ", "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{red}\\\\ddot{\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", 
   "\"\<}}\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"sPrime", "[", "x_", "]"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{blue}\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", 
   "\"\<^{\\\\prime}}\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"dPrime", "[", "x_", "]"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"\"\<{\\\\color{red}\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", 
   "\"\<^{\\\\prime\\\\prime}}\>\""}]}]}], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.671619245359039*^9}, 3.6716192890859156`*^9, {
   3.6716230029556026`*^9, 3.6716230047028055`*^9}, {3.6716230382691417`*^9, 
   3.671623059643364*^9}, {3.67162344045519*^9, 3.6716234473504024`*^9}, {
   3.6716234949304857`*^9, 3.671623506802107*^9}, {3.671623549764582*^9, 
   3.671623555208992*^9}, {3.6716236774040065`*^9, 3.671623677762807*^9}, {
   3.6716389772201567`*^9, 3.671639000947798*^9}, {3.6716404143570805`*^9, 
   3.671640418569088*^9}, {3.671690466191696*^9, 3.6716904829149256`*^9}, {
   3.671690535518218*^9, 3.6716905398862257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"subScr", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"y_", "?", "StringQ"}]}], "]"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", "\"\<_{\>\"", " ", "<>", " ", 
   "y", " ", "<>", " ", "\"\<}\>\""}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.671619245359039*^9}, 3.6716192890859156`*^9, {
   3.6716230029556026`*^9, 3.6716230047028055`*^9}, {3.6716230382691417`*^9, 
   3.671623059643364*^9}, {3.67162344045519*^9, 3.6716234473504024`*^9}, {
   3.6716234949304857`*^9, 3.671623506802107*^9}, {3.671623549764582*^9, 
   3.671623555208992*^9}, {3.6716236774040065`*^9, 3.671623677762807*^9}, {
   3.6716389772201567`*^9, 3.671639000947798*^9}, {3.6716404143570805`*^9, 
   3.671640418569088*^9}, {3.671690466191696*^9, 3.6716904864717317`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"Power", "[", " ", 
    RowBox[{
     RowBox[{"\[DifferentialD]", "x_"}], ",", " ", "n_"}], " ", "]"}], " ", 
   "]"}], " ", ":=", " ", 
  RowBox[{"\"\<\\\\mathrm{d}\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", "\"\<^{\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "n"}], " ", "<>", " ", "\"\<}\>\""}]}], "\n", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"\[DifferentialD]", "x_"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"\"\<\\\\mathrm{d}\>\"", " ", "<>", " ", 
   RowBox[{"Tex", "@", "x"}]}]}]}], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.671619245359039*^9}, 3.6716192890859156`*^9, {
   3.6716230029556026`*^9, 3.6716230047028055`*^9}, {3.6716230382691417`*^9, 
   3.671623059643364*^9}, {3.67162344045519*^9, 3.6716234473504024`*^9}, {
   3.6716234949304857`*^9, 3.671623506802107*^9}, {3.671623549764582*^9, 
   3.671623555208992*^9}, {3.6716236774040065`*^9, 3.671623677762807*^9}, {
   3.6716389772201567`*^9, 3.671639000947798*^9}, {3.6716404143570805`*^9, 
   3.671640418569088*^9}, {3.671690466191696*^9, 3.6716904864717317`*^9}, {
   3.671690548481841*^9, 3.6716905939715204`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"x_", " ", "\[Element]", " ", "Reals"}], " ", "]"}], " ", ":=", 
  " ", 
  RowBox[{
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", 
   "\"\<\\\\in\\\\mathbb{R}\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", " ", 
   RowBox[{"x_", " ", "\[NotEqual]", " ", "y_"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Tex", "@", "x"}], " ", "<>", " ", "\"\<\\\\ne\>\"", " ", "<>", 
   " ", 
   RowBox[{"Tex", "@", "y"}]}]}]}], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.671619245359039*^9}, 3.6716192890859156`*^9, {
   3.6716230029556026`*^9, 3.6716230047028055`*^9}, {3.6716230382691417`*^9, 
   3.671623059643364*^9}, {3.67162344045519*^9, 3.6716234473504024`*^9}, {
   3.6716234949304857`*^9, 3.671623506802107*^9}, {3.671623549764582*^9, 
   3.671623555208992*^9}, {3.6716236774040065`*^9, 3.671623677762807*^9}, {
   3.6716389772201567`*^9, 3.671639000947798*^9}, 3.67165151030663*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sc\[CapitalPhi]$pnTex", "[", " ", 
   RowBox[{"p_", ",", " ", 
    RowBox[{"q_:", "0"}], ",", " ", 
    RowBox[{"r_:", "0"}], ",", " ", 
    RowBox[{"s_:", "0"}]}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"StringJoin", "[", " ", "\n", "\t", 
   RowBox[{"\"\<{\\\\color{red},\>\"", ",", "\n", "\t", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"p", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]", 
        " ", "0"}]}], ",", " ", "\"\<\>\"", ",", " ", 
      RowBox[{"StringRepeat", "[", " ", 
       RowBox[{
        RowBox[{"\"\< \>\"", " ", "<>", " ", 
         RowBox[{"Tex", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "1", "\[RightDoubleBracket]"}], "]"}], "]"}]}], ",", " ", "p"}], 
       " ", "]"}]}], " ", "]"}], ",", "\n", "\t", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"q", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]", 
        " ", "1"}]}], ",", " ", "\"\<\>\"", ",", " ", 
      RowBox[{"StringRepeat", "[", " ", 
       RowBox[{
        RowBox[{"\"\< \>\"", " ", "<>", " ", 
         RowBox[{"Tex", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "]"}], "]"}]}], ",", " ", "q"}], 
       " ", "]"}]}], " ", "]"}], ",", "\n", "\t", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"r", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]", 
        " ", "2"}]}], ",", " ", "\"\<\>\"", ",", " ", 
      RowBox[{"StringRepeat", "[", " ", 
       RowBox[{
        RowBox[{"\"\< \>\"", " ", "<>", " ", 
         RowBox[{"Tex", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "3", "\[RightDoubleBracket]"}], "]"}], "]"}]}], ",", " ", "r"}], 
       " ", "]"}]}], " ", "]"}], ",", "\n", "\t", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"s", " ", "\[LessEqual]", " ", "0"}], " ", "\[Or]", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "]"}], " ", "\[LessEqual]", 
        " ", "3"}]}], ",", " ", "\"\<\>\"", ",", " ", 
      RowBox[{"StringRepeat", "[", " ", 
       RowBox[{
        RowBox[{"\"\< \>\"", " ", "<>", " ", 
         RowBox[{"Tex", "[", 
          RowBox[{"Head", "[", 
           RowBox[{
            RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", 
            "4", "\[RightDoubleBracket]"}], "]"}], "]"}]}], ",", " ", "s"}], 
       " ", "]"}]}], " ", "]"}], ",", "\n", "\t", "\"\<}\>\""}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192462794404`*^9}, {3.6716230695069284`*^9, 
   3.67162307547727*^9}, {3.671623407882333*^9, 3.6716234105343375`*^9}, {
   3.6716234621080284`*^9, 3.6716234758672523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tex$Nice", "[", " ", "expr_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"expr", " ", "/.", " ", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "2", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", "1",
          "\[RightDoubleBracket]"}], "]"}], "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"dDot", "[", "a", "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "2", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", "2",
          "\[RightDoubleBracket]"}], "]"}], "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"dPrime", "[", "a", "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", "1",
          "\[RightDoubleBracket]"}], "]"}], "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"sDot", "[", "a", "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"{", "\[CapitalPhi]ield", "}"}], "\[LeftDoubleBracket]", "2",
          "\[RightDoubleBracket]"}], "]"}], "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"sPrime", "[", "a", "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"p_", ",", "q_", ",", "r_", ",", "s_"}], "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       "\[CapitalPhi]ield", "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"subScr", "[", 
       RowBox[{"a", ",", 
        RowBox[{"sc\[CapitalPhi]$pnTex", "[", 
         RowBox[{"p", ",", "q", ",", "r", ",", "s"}], "]"}]}], "]"}]}], ",", 
     "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"p_", ",", "q_", ",", "r_"}], "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       "\[CapitalPhi]ield", "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"subScr", "[", 
       RowBox[{"a", ",", 
        RowBox[{"sc\[CapitalPhi]$pnTex", "[", 
         RowBox[{"p", ",", "q", ",", "r"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"p_", ",", "q_"}], "]"}], "[", 
        RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "]"}], "[", 
       "\[CapitalPhi]ield", "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"subScr", "[", 
       RowBox[{"a", ",", 
        RowBox[{"sc\[CapitalPhi]$pnTex", "[", 
         RowBox[{"p", ",", "q"}], "]"}]}], "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"a_", "?", "\[CapitalPhi]ieldQ"}], "[", "any__", "]"}], " ", 
      "\[RuleDelayed]", " ", "a"}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192462794404`*^9}, {3.6720610608814726`*^9, 
   3.6720610624102755`*^9}, {3.672066353835392*^9, 3.672066356128596*^9}, {
   3.6720670962250957`*^9, 3.672067097504298*^9}, {3.672067632508238*^9, 
   3.6720676333662395`*^9}, {3.672067850612221*^9, 3.672067851345422*^9}, {
   3.6720680970302534`*^9, 3.672068102490263*^9}, {3.672077132377515*^9, 
   3.672077133017116*^9}, {3.6999665414037113`*^9, 3.699966544664117*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"texNice", "[", " ", 
   RowBox[{"expr_", ",", " ", 
    RowBox[{"pre_:", "\"\<\>\""}], ",", " ", 
    RowBox[{"post_:", "\"\<\>\""}]}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"expr", " ", "//", " ", "tex$Nice"}], " ", "//", " ", 
       "TexPrint"}]}], ";", "\n", "\t", 
     RowBox[{"pre", " ", "<>", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", " ", "//", " ", "xAct`TexAct`Private`TexFix"}], " ", "//",
         " ", 
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\"\<, \>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}], "&"}]}], 
       ")"}], " ", "<>", " ", "post"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192381362257`*^9}, {3.6716221934230165`*^9, 
   3.671622194015818*^9}, {3.6716389122772427`*^9, 3.6716389317460766`*^9}, {
   3.671639262887858*^9, 3.6716393174567537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"texNiceAligned", "[", " ", 
   RowBox[{"expr_", ",", " ", 
    RowBox[{"pre_:", "\"\<\>\""}], ",", " ", 
    RowBox[{"post_:", "\"\<\>\""}]}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"expr", " ", "//", " ", "tex$Nice"}], " ", "//", " ", 
       "TexPrintAlignedEquations"}]}], ";", "\n", "\t", 
     RowBox[{"pre", " ", "<>", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", " ", "//", " ", "xAct`TexAct`Private`TexFix"}], " ", "//",
         " ", 
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\"\<, \>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}], "&"}]}], 
       ")"}], " ", "<>", " ", "post"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.671619239259428*^9}, {3.6716221958566213`*^9, 
   3.6716221961998215`*^9}, {3.671639330513977*^9, 3.6716393376587896`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"texNiceMatrix", "[", " ", 
   RowBox[{"expr_", ",", " ", 
    RowBox[{"pre_:", "\"\<\>\""}], ",", " ", 
    RowBox[{"post_:", "\"\<\>\""}]}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"expr", " ", "//", " ", "tex$Nice"}], " ", "//", " ", 
       "TexMatrix"}]}], ";", "\n", "\t", 
     RowBox[{"pre", " ", "<>", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", " ", "//", " ", "xAct`TexAct`Private`TexFix"}], " ", "//",
         " ", 
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\"\<, \>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}], "&"}]}], 
       ")"}], " ", "<>", " ", "post"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.671619239259428*^9}, {3.671622197915825*^9, 
   3.671622198430626*^9}, {3.671638938719289*^9, 3.6716389525565133`*^9}, 
   3.6716393472528067`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"log", "[", " ", "expr_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "tex$log", "]"}], "===", "0"}], ",", " ", 
       RowBox[{"tex$log", " ", "=", " ", 
        RowBox[{"{", "}"}]}]}], " ", "]"}], ";", "\n", "\t", 
     RowBox[{"AppendTo", "[", " ", 
      RowBox[{"tex$log", ",", " ", 
       RowBox[{"ToString", "@", "expr"}]}], " ", "]"}], ";", "\n", "\t", 
     "expr"}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192381362257`*^9}, {3.6716221934230165`*^9, 
   3.671622194015818*^9}, {3.6716222569619284`*^9, 3.6716223345876646`*^9}, {
   3.671622798591381*^9, 3.6716228625670934`*^9}}],

Cell[BoxData[
 RowBox[{"logNL", " ", ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"log", "@", "\"\<\>\""}], ";"}], ")"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192381362257`*^9}, {3.6716221934230165`*^9, 
   3.671622194015818*^9}, {3.6716222569619284`*^9, 3.6716223345876646`*^9}, {
   3.671622798591381*^9, 3.671622871474709*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"flushTexLog", "[", " ", 
   RowBox[{
    RowBox[{"filename_:", "\"\<default-log.tex\>\""}], ",", " ", 
    RowBox[{"tex_:", 
     RowBox[{"{", "}"}]}]}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", " ", "str", " ", "}"}], ",", "\n", "\t", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "tex", "]"}], " ", "=!=", " ", "0"}], ",", "\n",
       "\t\t", 
      RowBox[{
       RowBox[{"str", " ", "=", " ", 
        RowBox[{"OpenWrite", "[", " ", "filename", " ", "]"}]}], ";", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"WriteLine", "[", 
          RowBox[{"str", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
         "\"\<\\\\documentclass[11pt]{article}\>\"", ",", " ", "\"\<\>\"", 
          ",", "\n", "\t\t\t", "\"\<\\\\usepackage[latin9]{inputenc}\>\"", 
          ",", "\n", "\t\t\t", "\"\<\\\\usepackage[a4paper]{geometry}\>\"", 
          ",", "\n", "\t\t\t", 
          "\"\<\\\\geometry{verbose,tmargin=2cm,bmargin=2cm,lmargin=2cm,\
rmargin=2cm}\>\"", ",", " ", "\"\<\>\"", ",", "\n", "\t\t\t", 
          "\"\<\\\\usepackage{amsmath,amssymb,bm,color,cancel}\>\"", ",", 
          " ", "\"\<\>\"", ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<%%%% Timestamp: \>\"", ",", "\"\<Year\>\"", ",", 
              "\"\<-\>\"", ",", "\"\<Month\>\"", ",", "\"\<-\>\"", ",", 
              "\"\<Day\>\"", ",", "\"\< \>\"", ",", "\"\<Hour\>\"", ",", 
              "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", "\"\<:\>\"", ",", 
              "\"\<Second\>\""}], "}"}], "]"}], "\n", "\t\t\t", "\"\<\>\""}], 
          ",", " ", "\"\<\\\\begin{document}\>\"", ",", " ", "\"\<\>\""}], 
         "\n", "\t\t", "}"}]}], ";", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"WriteLine", "[", 
          RowBox[{"str", ",", "#"}], "]"}], "&"}], " ", "/@", " ", "tex"}], 
       ";", "\n", "\t\t", 
       RowBox[{"WriteLine", "[", " ", 
        RowBox[{"str", ",", " ", "\"\<\>\""}], " ", "]"}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"WriteLine", "[", " ", 
        RowBox[{"str", ",", " ", "\"\<\\\\end{document}\>\""}], " ", "]"}], 
       ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Close", "[", "str", "]"}], ";"}]}], "\n", "\t", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192406478305`*^9}, {3.671622425832225*^9, 
   3.671622454988676*^9}, {3.671622542176031*^9, 3.6716227083475227`*^9}, {
   3.6716229085871744`*^9, 3.671622909086375*^9}, {3.6716406148018327`*^9, 
   3.6716406152074337`*^9}, {3.671644590825136*^9, 3.6716446130083747`*^9}, {
   3.6716492463467917`*^9, 3.671649339666156*^9}, {3.6716493810218287`*^9, 
   3.6716493829562316`*^9}, {3.6716495513897276`*^9, 
   3.6716495518265285`*^9}, {3.6716508803827124`*^9, 3.6716509421900215`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"saveToTexFile", "[", " ", "file_", " ", "]"}], "[", " ", "tex_", 
   " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"SetDirectory", "[", " ", 
      RowBox[{"NotebookDirectory", "[", "]"}], " ", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"flushTexLog", "[", " ", 
      RowBox[{
       RowBox[{"file", " ", "<>", " ", "\"\<.tex\>\""}], ",", " ", "tex"}], 
      " ", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"texOut", "=", 
      RowBox[{"ReadList", "[", " ", 
       RowBox[{
        RowBox[{
        "\"\<!\>\"", " ", "<>", " ", "$LatexExecutable", " ", "<>", " ", 
         "\"\< \>\"", " ", "<>", " ", "file", " ", "<>", " ", 
         "\"\<.tex\>\""}], ",", " ", "String"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"DeleteFile", "@", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"file", " ", "<>", " ", "\"\<.log\>\""}], ",", " ", 
        RowBox[{"file", " ", "<>", " ", "\"\<.aux\>\""}]}], " ", "}"}]}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"ResetDirectory", " ", "[", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192406478305`*^9}, {3.671622425832225*^9, 
   3.671622454988676*^9}, {3.671622542176031*^9, 3.6716227083475227`*^9}, {
   3.6716229085871744`*^9, 3.671622909086375*^9}, {3.6716406148018327`*^9, 
   3.6716406152074337`*^9}, {3.671644590825136*^9, 3.6716446130083747`*^9}, {
   3.6716492463467917`*^9, 3.671649339666156*^9}, {3.6716493810218287`*^9, 
   3.6716493829562316`*^9}, {3.6716495513897276`*^9, 3.671649584742586*^9}, {
   3.6716509807532887`*^9, 3.67165102724137*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"texMatrixInBasis", "[", " ", 
    RowBox[{"B_", ",", " ", 
     RowBox[{"func_:", 
      RowBox[{"(", 
       RowBox[{"#", "&"}], ")"}]}]}], " ", "]"}], "[", " ", "e_", " ", "]"}], 
  ":=", "  ", 
  RowBox[{"texNiceMatrix", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"e", " ", "//", " ", 
            RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
           RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
          "TraceBasisDummy"}], " ", "//", " ", 
         "xAct`xTensor`ScreenDollarIndices"}], " ", "\n", "\t", "//", " ", 
        "ComponentArray"}], " ", "//", " ", "ToValues"}], " ", "//", " ", 
      "redefineFields"}], " ", "//", " ", "Simplify"}], " ", "//", " ", 
    "func"}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192406478305`*^9}, {3.671622425832225*^9, 
   3.671622454988676*^9}, {3.671622542176031*^9, 3.6716227083475227`*^9}, {
   3.6716229085871744`*^9, 3.671622909086375*^9}, {3.6716406148018327`*^9, 
   3.6716407101336*^9}, {3.671641175716418*^9, 3.671641209833678*^9}, {
   3.6716416653856783`*^9, 3.6716416805645046`*^9}, 3.6716898857770767`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"texInBasis", "[", " ", 
    RowBox[{"B_", ",", " ", 
     RowBox[{"func_:", 
      RowBox[{"(", 
       RowBox[{"#", "&"}], ")"}]}]}], " ", "]"}], "[", " ", "e_", " ", "]"}], 
  ":=", "  ", 
  RowBox[{"texNice", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"e", " ", "//", " ", 
             RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
            RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
           "TraceBasisDummy"}], " ", "//", " ", 
          "xAct`xTensor`ScreenDollarIndices"}], " ", "\n", "\t", "//", " ", 
         "ComponentArray"}], " ", "//", " ", "ToValues"}], " ", "//", " ", 
       "ToValues"}], " ", "//", " ", "redefineFields"}], " ", "//", " ", 
     "Simplify"}], " ", "//", " ", "func"}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192406478305`*^9}, {3.671622425832225*^9, 
   3.671622454988676*^9}, {3.671622542176031*^9, 3.6716227083475227`*^9}, {
   3.6716229085871744`*^9, 3.671622909086375*^9}, {3.6716406148018327`*^9, 
   3.6716407101336*^9}, {3.671641175716418*^9, 3.671641209833678*^9}, {
   3.6716416653856783`*^9, 3.6716417039021454`*^9}, {3.671642608968935*^9, 
   3.6716426099517365`*^9}, 3.671689888288681*^9, 3.699976889744756*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"texNonZeroComponents", "[", " ", 
    RowBox[{"B_", ",", " ", 
     RowBox[{"func_:", 
      RowBox[{"(", 
       RowBox[{"#", "&"}], ")"}]}]}], " ", "]"}], "[", " ", "e_", " ", "]"}], 
  " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", "\n", "  ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", " ", 
          RowBox[{
           RowBox[{"texNice", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], ",", " ", 
           RowBox[{
           "\"\<\\\\nabla \>\"", " ", "\[Rule]", " ", 
            "\"\<\\\\nabla_\>\""}]}], " ", "]"}], " ", "<>", " ", 
         "\"\< &= \>\"", " ", "<>", " ", 
         RowBox[{"myTexBreak", "@", 
          RowBox[{"texNice", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}]}], " ", "&"}], " ", "/@", " ", 
       RowBox[{"(", 
        RowBox[{"(", "\n", "\t", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "\n", "\t\t", 
              RowBox[{"#1", ",", "\n", "\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#1", " ", "//", " ", "TraceBasisDummy"}], " ", "//",
                     " ", "ComponentArray"}], " ", "//", " ", "ToValues"}], 
                   " ", "//", " ", "ToValues"}], " ", "//", " ", 
                  "redefineFields"}], " ", "//", " ", "Simplify"}], " ", "//",
                 " ", "func"}]}], "\n", "\t  ", "}"}], "&"}], " ", "/@", " ", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"e", " ", "//", " ", 
                  RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
                 RowBox[{"ToBasis", "[", "B", "]"}]}], " ", "//", " ", 
                "xAct`xTensor`ScreenDollarIndices"}], " ", "//", " ", 
               "ComponentArray"}], " ", "//", " ", "Flatten"}], " ", ")"}]}], 
           "\[IndentingNewLine]", "\t", ")"}], " ", "//", " ", 
          RowBox[{
           RowBox[{"Select", "[", " ", 
            RowBox[{"#1", ",", " ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                SubscriptBox["#1", 
                 RowBox[{"[", 
                  RowBox[{"[", "2", "]"}], "]"}]], " ", "=!=", " ", "0"}], 
               " ", ")"}], "&"}]}], " ", "]"}], "&"}]}], "\n", ")"}], ")"}]}],
       ")"}], " ", "//", " ", 
     RowBox[{
      RowBox[{"Riffle", "[", " ", 
       RowBox[{"#", ",", " ", "\"\<\\\\\\\\\>\""}], " ", "]"}], " ", "&"}]}], 
    " ", ")"}], " ", "/.", " ", 
   RowBox[{"List", " ", "\[Rule]", " ", "Sequence"}]}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192406478305`*^9}, {3.671622425832225*^9, 
   3.671622454988676*^9}, {3.671622542176031*^9, 3.6716227083475227`*^9}, {
   3.6716229085871744`*^9, 3.671622909086375*^9}, {3.6716406148018327`*^9, 
   3.6716407101336*^9}, {3.671641175716418*^9, 3.671641209833678*^9}, {
   3.6716416653856783`*^9, 3.6716417039021454`*^9}, {3.671642608968935*^9, 
   3.6716427107591143`*^9}, {3.671647972816104*^9, 3.6716479732373047`*^9}, {
   3.6716480779290886`*^9, 3.671648082655897*^9}, {3.6716527362727003`*^9, 
   3.671652768377557*^9}, 3.6716528876397657`*^9, {3.6716529718799143`*^9, 
   3.671652985327138*^9}, {3.671653054078782*^9, 3.6716530548119836`*^9}, {
   3.67168850856211*^9, 3.671688555798992*^9}, {3.6716886530495634`*^9, 
   3.6716886532211637`*^9}, {3.671688725825554*^9, 3.6716887270423555`*^9}, {
   3.671688795167675*^9, 3.6716888152293105`*^9}, 3.6716888590497875`*^9, 
   3.6716898907378855`*^9, {3.699976894681039*^9, 3.699976898640265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexPrintPageWidth", " ", "=", " ", "400"}], ";"}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192443606367`*^9}, {3.671644805586377*^9, 
   3.671644806147978*^9}, {3.671644854889326*^9, 3.67164485738533*^9}, {
   3.671647643630269*^9, 3.6716476438174696`*^9}, {3.671651557044312*^9, 
   3.6716515760919456`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", " ", 
  RowBox[{
   RowBox[{"\[Not]", 
    RowBox[{"MemberQ", "[", " ", 
     RowBox[{"$TexInitLatexPackages", ",", " ", "\"\<{color}\>\""}], " ", 
     "]"}]}], ",", "\n", "\t", 
   RowBox[{"AppendTo", "[", " ", 
    RowBox[{"$TexInitLatexPackages", ",", " ", "\"\<{color}\>\""}], " ", 
    "]"}]}], "\n", "]"}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192443606367`*^9}, {3.671644805586377*^9, 
   3.671644806147978*^9}, {3.671644854889326*^9, 3.67164485738533*^9}, {
   3.671647643630269*^9, 3.6716476438174696`*^9}, {3.671651557044312*^9, 
   3.6716515658739276`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"myTexBreak", "[", " ", "s_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"TexBreak", "[", " ", 
   RowBox[{"s", ",", " ", "400", ",", " ", 
    RowBox[{"{", "}"}], ",", "\n", "\t", 
    RowBox[{"TexBreakBy", " ", "\[Rule]", " ", "\"\<TexPoint\>\""}], ",", " ", 
    RowBox[{"TexBreakAt", " ", "\[Rule]", " ", 
     RowBox[{"\"\<+\>\"", "|", "\"\<-\>\""}]}], ",", " ", "\n", "\t", 
    RowBox[{
    "TexBreakString", " ", "\[Rule]", " ", 
     "\"\<\\\\nonumber\\\\\\\\\\n & \\\\quad\>\""}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6715987794401684`*^9, 3.671598797583*^9}, {
   3.671598841231877*^9, 3.671598900556463*^9}, {3.671598934892123*^9, 
   3.6715990678043566`*^9}, {3.671599195295988*^9, 3.671599205170805*^9}, {
   3.6715992429228716`*^9, 3.671599243328472*^9}, 3.6715993777227087`*^9, {
   3.671599498674549*^9, 3.6715995675330696`*^9}, {3.671599611618747*^9, 
   3.6715996120243483`*^9}, {3.6715996876064806`*^9, 3.671599690133685*^9}, 
   3.671599723018543*^9, {3.671599793265466*^9, 3.6715997964478717`*^9}, {
   3.6715999136674776`*^9, 3.671599986098405*^9}, {3.671600047546913*^9, 
   3.671600073115358*^9}, {3.6716006244808087`*^9, 3.6716006345272264`*^9}, {
   3.671600693869731*^9, 3.671600791947103*^9}, {3.6716008252999616`*^9, 
   3.671600831290372*^9}, {3.6716008914689593`*^9, 3.6716009113589945`*^9}, {
   3.6716018085633235`*^9, 3.6716018382657757`*^9}, {3.671601887203062*^9, 
   3.6716019023350887`*^9}, {3.671601953612378*^9, 3.671601955203581*^9}, {
   3.6716019904596434`*^9, 3.671602064029372*^9}, {3.6716021315774913`*^9, 
   3.671602135914299*^9}, {3.6716026342580366`*^9, 3.6716026464416575`*^9}, {
   3.671602685082926*^9, 3.6716027098713694`*^9}, {3.6716028626878643`*^9, 
   3.6716028683974743`*^9}, {3.6716032341869164`*^9, 3.671603307288645*^9}, {
   3.671603388009213*^9, 3.6716034278204827`*^9}, {3.6716034584433365`*^9, 
   3.67160347738177*^9}, {3.6716035669727273`*^9, 3.6716035989215837`*^9}, {
   3.671603660619692*^9, 3.6716036620080943`*^9}, {3.6716036972641563`*^9, 
   3.671603766543878*^9}, {3.6716040172673187`*^9, 3.6716040221813273`*^9}, {
   3.6716178320659375`*^9, 3.671617832643139*^9}, {3.671617872792859*^9, 
   3.671617921839345*^9}, {3.6716179584994097`*^9, 3.671617976158641*^9}, {
   3.671618152763237*^9, 3.6716182387661877`*^9}, {3.6716183543166733`*^9, 
   3.6716184628616643`*^9}, {3.671618498492127*^9, 3.671618513327753*^9}, {
   3.67161857986187*^9, 3.671618828167506*^9}, {3.6716189265256786`*^9, 
   3.6716190260694537`*^9}, {3.671619088953164*^9, 3.6716191928649464`*^9}, {
   3.6716192355310216`*^9, 3.6716192406478305`*^9}, {3.671622425832225*^9, 
   3.671622454988676*^9}, {3.671622542176031*^9, 3.6716227083475227`*^9}, {
   3.6716229085871744`*^9, 3.671622909086375*^9}, {3.6716406148018327`*^9, 
   3.6716407101336*^9}, {3.671641175716418*^9, 3.671641209833678*^9}, {
   3.6716416653856783`*^9, 3.6716417039021454`*^9}, {3.671642608968935*^9, 
   3.6716427107591143`*^9}, {3.671647972816104*^9, 3.671648003641758*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["General utility functions", "Subsection",
 CellChangeTimes->{{3.6558823261291285`*^9, 3.6558823336171417`*^9}, {
  3.655884616431551*^9, 3.6558846665700393`*^9}, {3.6570311739322453`*^9, 
  3.657031235411953*^9}, {3.6571373334836903`*^9, 3.657137354403327*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumeReal", "[", " ", 
   RowBox[{"v_", ",", " ", 
    RowBox[{"cond_:", " ", "True"}]}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", " ", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"$Assumptions", " ", "/.", " ", 
       RowBox[{"And", " ", "\[Rule]", " ", "List"}]}]}], " ", "}"}], ",", 
    "\n", "\t", 
    RowBox[{
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"\[Not]", 
        RowBox[{"MemberQ", "[", " ", 
         RowBox[{"s", ",", " ", 
          RowBox[{"v", " ", "\[Element]", " ", "Reals"}]}], " ", "]"}]}], ",",
        " ", 
       RowBox[{"$Assumptions", " ", "=", " ", 
        RowBox[{"$Assumptions", " ", "\[And]", " ", 
         RowBox[{"v", " ", "\[Element]", " ", "Reals"}]}]}]}], " ", "]"}], 
     ";", "\n", "\t", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"\[Not]", 
        RowBox[{"MemberQ", "[", " ", 
         RowBox[{"s", ",", " ", "cond"}], " ", "]"}]}], ",", " ", 
       RowBox[{"$Assumptions", " ", "=", " ", 
        RowBox[{"$Assumptions", " ", "\[And]", " ", "cond"}]}]}], " ", "]"}], 
     ";"}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.6571365142950516`*^9, 3.6571366115456223`*^9}, {
  3.657136641856476*^9, 3.6571366468016844`*^9}, {3.657136724536621*^9, 
  3.6571367247082214`*^9}, {3.6571373602221375`*^9, 3.6571373878185863`*^9}, {
  3.671632969481604*^9, 3.6716330443305354`*^9}, {3.6716332228104486`*^9, 
  3.6716332522165003`*^9}, {3.6716334145347853`*^9, 3.671633420603196*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnderBar", "[", " ", "f_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"f", "[", " ", "\[CapitalPhi]ield", " ", "]"}]}]], "Code",
 CellChangeTimes->{{3.656952258943391*^9, 3.656952263061798*^9}, 
   3.656952340047933*^9, 3.6570311359773784`*^9, {3.657125984341155*^9, 
   3.6571260106428013`*^9}, {3.6571271647494287`*^9, 3.657127179397854*^9}, {
   3.657136409930868*^9, 3.657136414548476*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defineField", "[", " ", "f_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"(", " ", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]ieldQ", "[", "f", "]"}], " ", "^=", " ", "True"}], 
    ";", " ", "\n", "\t", 
    RowBox[{"xAct`xTensor`DefScalarFunction", "[", "f", "]"}]}], "\n", 
   ")"}]}]], "Code",
 CellChangeTimes->{{3.6571271068577266`*^9, 3.657127140179385*^9}, 
   3.657136421225288*^9, {3.6571375094831996`*^9, 3.657137528546433*^9}, 
   3.6716209559508433`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defineField", "[", " ", 
   RowBox[{"f_", ",", " ", "options__"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"(", " ", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]ieldQ", "[", "f", "]"}], " ", "^=", " ", "True"}], 
    ";", " ", "\n", "\t", 
    RowBox[{"xAct`xTensor`DefScalarFunction", "[", " ", 
     RowBox[{"f", ",", " ", "options"}], " ", "]"}]}], "\n", ")"}]}]], "Code",
 CellChangeTimes->{{3.6571271068577266`*^9, 3.657127140179385*^9}, 
   3.657136421225288*^9, {3.6571375094831996`*^9, 3.657137528546433*^9}, 
   3.6716209559508433`*^9, {3.675087736474078*^9, 3.6750877487356997`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix utility functions", "Subsection",
 CellChangeTimes->{{3.655882930130989*^9, 3.6558829456062164`*^9}, {
  3.6571200131584663`*^9, 3.6571200218944817`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Elementary symmetric polynomials ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", "\[LessEqual]", "n", "\[LessEqual]", 
     RowBox[{"dim", " ", "\[ScriptCapitalM]"}]}], ")"}], TraditionalForm]]]
}], "Subsubsection"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalE]", "n"], "(", "S", ")"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox[
        SuperscriptBox["S", 
         SubscriptBox["a", "1"]], 
        RowBox[{"[", 
         SubscriptBox["a", "1"]}]], 
       SubscriptBox[
        SuperscriptBox["S", 
         SubscriptBox["a", "2"]], 
        SubscriptBox["a", "2"]]}], "..."}], 
     SubscriptBox[
      SuperscriptBox["S", 
       SubscriptBox["a", "n"]], 
      RowBox[{
       SubscriptBox["a", "n"], "]"}]]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.657136349012761*^9, 3.6571363495743628`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalE]", "[", " ", 
   RowBox[{
    RowBox[{"S_", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"-", "b_"}]}], "]"}], ",", " ", "0"}], " ", "]"}], " ", ":=", 
  " ", "1"}]], "Code",
 CellChangeTimes->{{3.657136003721755*^9, 3.6571360075593615`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalE]", "[", " ", 
   RowBox[{
    RowBox[{"S_", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"-", "b_"}]}], "]"}], ",", " ", "n_"}], " ", "]"}], " ", ":=", 
  " ", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", " ", "\n", "\t\t", 
     RowBox[{"indices", " ", "=", " ", 
      RowBox[{"xAct`xTensor`GetIndicesOfVBundle", "[", " ", 
       RowBox[{"Tangent\[ScriptCapitalM]", ",", " ", "n", ",", " ", 
        RowBox[{
         RowBox[{
         "xAct`xTensor`IndicesOfVBundle", "[", "Tangent\[ScriptCapitalM]", 
          "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       " ", "]"}]}], "\n", "\t", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"xAct`xTensor`Antisymmetrize", "[", " ", 
     RowBox[{
      RowBox[{"Product", "[", " ", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"\[ScriptZ]", ",", 
          RowBox[{"-", "\[ScriptZ]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[ScriptZ]", ",", "indices"}], "}"}]}], " ", "]"}], ",", 
      " ", 
      RowBox[{"-", "indices"}]}], " ", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.6571360094625645`*^9, 3.6571360735318775`*^9}, 
   3.671620874705901*^9, {3.671621012110942*^9, 3.6716210157457485`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Matrix power (for integer ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[GreaterEqual]", "0"}], TraditionalForm]]],
 ")"
}], "Subsubsection"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox[
      RowBox[{"[", 
       RowBox[{
        SubscriptBox["\[ScriptCapitalP]", "n"], "(", "S", ")"}], "]"}], "a"], 
     "b"], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox[
        SuperscriptBox["S", "a"], 
        SubscriptBox["a", "1"]], 
       SubscriptBox[
        SuperscriptBox["S", 
         SubscriptBox["a", "1"]], 
        SubscriptBox["a", "2"]]}], "..."}], 
     SubscriptBox[
      SuperscriptBox["S", 
       SubscriptBox["a", 
        RowBox[{"n", "-", "1"}]]], "b"]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.6571363449255543`*^9, 3.6571363461111565`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalP]", "[", " ", 
   RowBox[{
    RowBox[{"S_", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"-", "b_"}]}], "]"}], ",", " ", "0"}], " ", "]"}], " ", ":=", 
  " ", "1"}]], "Code",
 CellChangeTimes->{{3.6571360467622304`*^9, 3.6571360497886353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalP]", "[", " ", 
   RowBox[{
    RowBox[{"S_", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"-", "b_"}]}], "]"}], ",", " ", "n_"}], " ", "]"}], " ", ":=", 
  " ", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"iMid", " ", "=", " ", 
       RowBox[{"xAct`xTensor`GetIndicesOfVBundle", "[", " ", 
        RowBox[{"Tangent\[ScriptCapitalM]", ",", " ", 
         RowBox[{"n", "-", "1"}], ",", " ", 
         RowBox[{"Join", "[", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", " ", 
           RowBox[{
            RowBox[{
            "xAct`xTensor`IndicesOfVBundle", "[", "Tangent\[ScriptCapitalM]", 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          " ", "]"}]}], " ", "]"}]}], ",", "\n", "\t\t", "iTop", ",", 
      "iBot"}], "\n", "\t", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"iTop", " ", "=", " ", 
      RowBox[{"Join", "[", " ", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", " ", "iMid"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"iBot", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{"Join", "[", " ", 
        RowBox[{"iMid", ",", " ", 
         RowBox[{"{", "b", "}"}]}], " ", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Product", "[", " ", "\n", "\t\t", 
      RowBox[{
       RowBox[{"S", "[", " ", 
        RowBox[{"\[ScriptZ]", " ", "/.", " ", 
         RowBox[{"List", " ", "\[Rule]", " ", "Sequence"}]}], " ", "]"}], ",",
        " ", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"\[ScriptZ]", ",", " ", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"iTop", ",", "iBot"}], "}"}], "]"}]}], " ", "}"}]}], " ", 
      "\n", "\t", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.657136051598239*^9, 3.6571361496756115`*^9}, {
  3.671621019084154*^9, 3.671621020737757*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Derivatives of symmetric polynomials of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "=", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["g", 
       RowBox[{"-", "1"}]], "f"}]]}], TraditionalForm]]],
 " with respect to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", 
    RowBox[{"a", "\[InvisibleComma]", "b"}]], TraditionalForm]]]
}], "Subsubsection"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox[
      RowBox[{"[", 
       RowBox[{
        SuperscriptBox["Y", "n"], "(", "S", ")"}], "]"}], "a"], "b"], " ", ":=",
     " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"k", "=", "0"}], "n"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "k"], 
      SubscriptBox[
       SuperscriptBox[
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalE]", "n"], "(", "S", ")"}], 
         "\[VeryThinSpace]", "[", 
         SuperscriptBox["S", 
          RowBox[{"n", "-", "k"}]], "]"}], "c"], "b"]}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.6571363399647455`*^9, 3.657136340588746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalY]", "[", " ", 
   RowBox[{
    RowBox[{"S_", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"-", "b_"}]}], "]"}], ",", " ", "n_"}], " ", "]"}], " ", ":=", 
  "\n", "\t", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"k", "=", "0"}], "n"], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "k"], " ", 
    RowBox[{"\[ScriptCapitalE]\[ScriptCapitalP]", "[", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"a", ",", 
        RowBox[{"-", "b"}]}], "]"}], ",", " ", "n", ",", " ", "k"}], " ", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.6571361556660213`*^9, 3.6571361691444454`*^9}, {
  3.67202242899503*^9, 3.672022431163434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalE]\[ScriptCapitalP]", "[", " ", 
   RowBox[{
    RowBox[{"S_", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"-", "b_"}]}], "]"}], ",", " ", "n_", ",", " ", "k_"}], " ", 
   "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "indices", ",", " ", "iMid", ",", " ", "iTop", ",", " ", "iBot", ",", 
      " ", "e", ",", " ", "p"}], "\n", "\t", "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"indices", " ", "=", " ", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"k", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"{", "}"}], ",", "\n", "\t\t", 
        RowBox[{"xAct`xTensor`GetIndicesOfVBundle", "[", " ", 
         RowBox[{"Tangent\[ScriptCapitalM]", ",", " ", "k", ",", " ", 
          RowBox[{
           RowBox[{
           "xAct`xTensor`IndicesOfVBundle", "[", "Tangent\[ScriptCapitalM]", 
            "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         " ", "]"}]}], "\n", "\t", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"iMid", " ", "=", " ", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"n", " ", "\[LessEqual]", " ", "k"}], ",", " ", 
        RowBox[{"{", "}"}], ",", "\n", "\t\t", 
        RowBox[{"xAct`xTensor`GetIndicesOfVBundle", "[", " ", 
         RowBox[{"Tangent\[ScriptCapitalM]", ",", " ", 
          RowBox[{"n", "-", "k", "-", "1"}], ",", " ", 
          RowBox[{"Join", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}], ",", " ", "indices", ",", " ", 
            RowBox[{
             RowBox[{
             "xAct`xTensor`IndicesOfVBundle", "[", "Tangent\[ScriptCapitalM]",
               "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], " ", "]"}]}], " ", "]"}]}], "\n", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"iTop", " ", "=", " ", 
      RowBox[{"Join", "[", " ", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", " ", "iMid"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"iBot", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{"Join", "[", " ", 
        RowBox[{"iMid", ",", " ", 
         RowBox[{"{", "b", "}"}]}], " ", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"e", " ", "=", " ", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"k", " ", "\[LessEqual]", " ", "0"}], ",", " ", "1", ",", 
        "\n", "\t\t", 
        RowBox[{"xAct`xTensor`Antisymmetrize", "[", " ", 
         RowBox[{
          RowBox[{"Product", "[", " ", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"\[ScriptZ]", ",", 
              RowBox[{"-", "\[ScriptZ]"}]}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[ScriptZ]", ",", "indices"}], "}"}]}], " ", "]"}], ",",
           " ", 
          RowBox[{"-", "indices"}]}], " ", "]"}]}], "\n", "\t", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"n", " ", "\[LessEqual]", " ", "k"}], ",", " ", 
        RowBox[{"g\[CloverLeaf]", "[", 
         RowBox[{"a", ",", 
          RowBox[{"-", "b"}]}], "]"}], ",", "\n", "\t\t", 
        RowBox[{"Product", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"S", "[", " ", 
           RowBox[{"\[ScriptZ]", " ", "/.", " ", 
            RowBox[{"List", " ", "\[Rule]", " ", "Sequence"}]}], " ", "]"}], 
          ",", "\n", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{"\[ScriptZ]", ",", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"iTop", ",", "iBot"}], "}"}], "]"}]}], " ", "}"}]}], 
         " ", "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"e", " ", "p"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.6571250510695157`*^9, 3.657125051334716*^9}, {
  3.6571361728260517`*^9, 3.657136322804715*^9}, {3.6716210238577623`*^9, 
  3.671621031486176*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities to save reports", "Section",
 CellChangeTimes->{{3.6714468224986353`*^9, 3.671446829955062*^9}, {
  3.671446898587988*^9, 3.6714469086265616`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"createReport", "[", " ", 
   RowBox[{"title_:", " ", "Null"}], " ", "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", " ", 
   RowBox[{
    RowBox[{"xAct`Bim`printerConf", " ", "===", " ", "2"}], ",", " ", 
    RowBox[{"Block", "[", " ", 
     RowBox[{
      RowBox[{"{", " ", "fn", " ", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"if", " ", "does", " ", "not", " ", "exist", " ", "object"}], 
        " ", "*)"}], "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Not]", " ", 
          RowBox[{"ValueQ", "@", "nb"}]}], " ", "\[Or]", " ", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"NotebookInformation", "[", "nb", "]"}], " ", "//", " ", 
            "Head"}], " ", ")"}], " ", "\[Equal]", " ", "Symbol"}]}], ",", 
        " ", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Then", " ", "*)"}], " ", "\n", "\t\t", 
        RowBox[{
         RowBox[{"nb", " ", "=", " ", 
          RowBox[{"CreateDocument", " ", "[", "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"SetOptions", "[", " ", 
          RowBox[{"nb", ",", " ", 
           RowBox[{"Magnification", " ", "\[Rule]", " ", "1.25"}]}], " ", 
          "]"}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"title", " ", "=!=", " ", "Null"}], ",", " ", 
           RowBox[{"NotebookWrite", "[", " ", 
            RowBox[{"nb", ",", " ", 
             RowBox[{"Cell", "[", " ", 
              RowBox[{"title", ",", " ", "\"\<Title\>\""}], " ", "]"}]}], " ",
             "]"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"fn", " ", "=", " ", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Created: \>\"", ",", "\"\<Year\>\"", ",", "\"\<-\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<-\>\"", ",", "\"\<Day\>\"", ",", 
             "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
             "\"\<Minute\>\"", ",", "\"\<:\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"NotebookWrite", "[", " ", 
          RowBox[{"nb", ",", " ", 
           RowBox[{"Cell", "[", " ", 
            RowBox[{"fn", ",", " ", "\"\<Text\>\""}], " ", "]"}]}], " ", 
          "]"}]}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Else", " ", "*)"}], "\n", "\t\t", "Null", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Error", " ", "*)"}], "\n", "\t\t", 
        RowBox[{"SetOptions", "[", " ", 
         RowBox[{"nb", ",", " ", 
          RowBox[{"Visible", " ", "\[Rule]", " ", "True"}]}], " ", "]"}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], "\n", "]"}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.6714464917777195`*^9, 3.6714465415425653`*^9}, {
   3.671446623983281*^9, 3.67144662414229*^9}, {3.6714468643560295`*^9, 
   3.671446874164591*^9}, {3.671449006101003*^9, 3.6714490125438147`*^9}, 
   3.671449506816083*^9, {3.6714526439201927`*^9, 3.6714526697694387`*^9}, {
   3.6714546462594137`*^9, 3.6714546863046846`*^9}, {3.6717820080270476`*^9, 
   3.6717820293366475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeExpr", "[", " ", "expr_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"Echo", "[", "expr", "]"}]}]], "Code",
 CellChangeTimes->{{3.671446688757986*^9, 3.67144671942074*^9}, {
  3.671446777972089*^9, 3.671446793603983*^9}, {3.6714468795548987`*^9, 
  3.67144689163459*^9}, {3.671446966268859*^9, 3.6714470018428936`*^9}, {
  3.6714546990499067`*^9, 3.671454699299507*^9}, {3.6717817010770454`*^9, 
  3.6717817065838456`*^9}, {3.671782578503851*^9, 3.671782580485051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeExpr", "[", " ", "expr_", " ", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"createReport", "[", "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"NotebookWrite", "[", " ", 
       RowBox[{"nb", ",", " ", 
        RowBox[{"Cell", "[", 
         RowBox[{
          RowBox[{"ToBoxes", "[", 
           RowBox[{"ExpressionCell", "[", " ", 
            RowBox[{"expr", ",", " ", "\"\<Output\>\""}], " ", "]"}], "]"}], 
          ",", " ", "\"\<Text\>\""}], " ", "]"}]}], " ", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], " ", "/;", " ", 
   RowBox[{"xAct`Bim`printerConf", " ", "===", " ", "2"}]}]}]], "Code",
 CellChangeTimes->{{3.671446688757986*^9, 3.67144671942074*^9}, {
  3.671446777972089*^9, 3.671446793603983*^9}, {3.6714468795548987`*^9, 
  3.67144689163459*^9}, {3.671446966268859*^9, 3.6714470018428936`*^9}, {
  3.6714546990499067`*^9, 3.671454699299507*^9}, {3.6717817010770454`*^9, 
  3.6717817022314453`*^9}, {3.6717817734922457`*^9, 3.6717817802314463`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeExpr", "[", " ", "expr_", " ", "]"}], " ", ":=", " ", 
  RowBox[{"expr", " ", "/;", " ", 
   RowBox[{"xAct`Bim`printerConf", " ", "===", " ", "3"}]}]}]], "Code",
 CellChangeTimes->{{3.671446688757986*^9, 3.67144671942074*^9}, {
  3.671446777972089*^9, 3.671446793603983*^9}, {3.6714468795548987`*^9, 
  3.67144689163459*^9}, {3.671446966268859*^9, 3.6714470018428936`*^9}, {
  3.6714546990499067`*^9, 3.671454699299507*^9}, {3.6717817010770454`*^9, 
  3.6717817022314453`*^9}, {3.6717817734922457`*^9, 3.6717817802314463`*^9}, {
  3.6717825606418505`*^9, 3.671782572076651*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeCell", "[", " ", 
   RowBox[{"contents_", ",", " ", 
    RowBox[{"style_:", "\"\<Subsubsection\>\""}]}], " ", "]"}], " ", ":=", 
  " ", 
  RowBox[{"If", "[", " ", 
   RowBox[{
    RowBox[{"xAct`Bim`printerConf", " ", "===", " ", "2"}], ",", " ", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"createReport", "[", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"NotebookWrite", "[", " ", 
      RowBox[{"nb", ",", " ", 
       RowBox[{"Cell", "[", " ", 
        RowBox[{"contents", ",", " ", "style"}], " ", "]"}]}], " ", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.671446688757986*^9, 3.67144671942074*^9}, {
  3.671446751972602*^9, 3.671446785491519*^9}, {3.671446881795027*^9, 
  3.671446888875432*^9}, {3.671446919996212*^9, 3.6714469466827383`*^9}, {
  3.671446988514131*^9, 3.6714470036109943`*^9}, {3.6714507505594673`*^9, 
  3.6714507509962683`*^9}, {3.6714547012807107`*^9, 3.671454701499111*^9}, {
  3.671781442412444*^9, 3.671781444378044*^9}, {3.6717817137286453`*^9, 
  3.671781762353846*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 CellChangeTimes->{{3.6716201713474655`*^9, 3.6716201828446856`*^9}}],

Cell[BoxData[
 RowBox[{"EndPackage", " ", "[", "]"}]], "Code",
 CellChangeTimes->{3.6716201692726617`*^9}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1211, 1032},
WindowMargins->{{219, Automatic}, {34, Automatic}},
DockedCells->{},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.98},
"PrintingMargins"->{{28.346456999999997`, 28.346456999999997`}, {22.6771656, \
28.346456999999997`}}},
ShowSelection->True,
TaggingRules->{"NotebookTemplateVersion" -> 1., "NotebookTemplate" -> True},
CellContext->Notebook,
TrackCellChangeTimes->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Code"], Background -> None]}, Visible -> False, 
  FrontEndVersion -> "10.3 for Microsoft Windows (64-bit) (October 9, 2015)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 169, 2, 113, "Title"],
Cell[751, 26, 949, 23, 109, "Code"],
Cell[1703, 51, 2790, 53, 417, "Code"],
Cell[4496, 106, 142, 1, 38, "Text"],
Cell[CellGroupData[{
Cell[4663, 111, 46, 0, 42, "Subsubsection"],
Cell[4712, 113, 936, 19, 87, "Code"],
Cell[5651, 134, 1131, 20, 65, "Code"],
Cell[6785, 156, 1421, 25, 175, "Code"],
Cell[8209, 183, 28, 0, 38, "Text"],
Cell[8240, 185, 568, 10, 42, "Code"],
Cell[8811, 197, 302, 7, 39, "Text"],
Cell[9116, 206, 1666, 37, 197, "Code"],
Cell[10785, 245, 349, 8, 42, "Code"],
Cell[11137, 255, 433, 9, 42, "Code"],
Cell[11573, 266, 320, 8, 42, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11930, 279, 232, 3, 42, "Subsubsection"],
Cell[12165, 284, 508, 10, 65, "Code"],
Cell[12676, 296, 1290, 26, 109, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14003, 327, 267, 3, 53, "Subsection"],
Cell[14273, 332, 302, 7, 39, "Text"],
Cell[14578, 341, 549, 12, 42, "Code"],
Cell[15130, 355, 3298, 48, 42, "Code"],
Cell[18431, 405, 6034, 114, 175, "Code"],
Cell[24468, 521, 7265, 145, 291, "Code"],
Cell[31736, 668, 2054, 41, 153, "Code"],
Cell[33793, 711, 1008, 18, 42, "Code"],
Cell[34804, 731, 2160, 44, 153, "Code"],
Cell[36967, 777, 3642, 75, 263, "Code"],
Cell[40612, 854, 1275, 22, 42, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41924, 881, 545, 14, 57, "Subsection"],
Cell[42472, 897, 4251, 73, 109, "Code"],
Cell[46726, 972, 3681, 59, 109, "Code"],
Cell[50410, 1033, 2885, 42, 42, "Code"],
Cell[53298, 1077, 3223, 49, 65, "Code"],
Cell[56524, 1128, 3004, 47, 81, "Code"],
Cell[59531, 1177, 5440, 107, 246, "Code"],
Cell[64974, 1286, 5964, 118, 301, "Code"],
Cell[70941, 1406, 3108, 53, 136, "Code"],
Cell[74052, 1461, 3077, 52, 136, "Code"],
Cell[77132, 1515, 3085, 53, 136, "Code"],
Cell[80220, 1570, 2858, 46, 163, "Code"],
Cell[83081, 1618, 2384, 34, 52, "Code"],
Cell[85468, 1654, 5107, 90, 548, "Code"],
Cell[90578, 1746, 3832, 65, 218, "Code"],
Cell[94413, 1813, 3330, 57, 136, "Code"],
Cell[97746, 1872, 3448, 59, 136, "Code"],
Cell[101197, 1933, 5984, 116, 246, "Code"],
Cell[107184, 2051, 2387, 33, 52, "Code"],
Cell[109574, 2086, 2648, 40, 108, "Code"],
Cell[112225, 2128, 3037, 44, 136, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115299, 2177, 267, 3, 73, "Subsection"],
Cell[115569, 2182, 1560, 36, 163, "Code"],
Cell[117132, 2220, 425, 7, 52, "Code"],
Cell[117560, 2229, 520, 12, 136, "Code"],
Cell[118083, 2243, 648, 13, 136, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118768, 2261, 167, 2, 73, "Subsection"],
Cell[CellGroupData[{
Cell[118960, 2267, 248, 7, 61, "Subsubsection"],
Cell[119211, 2276, 704, 25, 52, "Text"],
Cell[119918, 2303, 294, 8, 52, "Code"],
Cell[120215, 2313, 1337, 32, 191, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121589, 2350, 160, 6, 95, "Subsubsection"],
Cell[121752, 2358, 722, 26, 81, "Text"],
Cell[122477, 2386, 296, 8, 81, "Code"],
Cell[122776, 2396, 2061, 51, 556, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124874, 2452, 378, 14, 113, "Subsubsection"],
Cell[125255, 2468, 783, 27, 82, "Text"],
Cell[126041, 2497, 741, 22, 187, "Code"],
Cell[126785, 2521, 4174, 97, 1027, "Code"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131008, 2624, 163, 2, 258, "Section"],
Cell[131174, 2628, 3227, 66, 1066, "Code"],
Cell[134404, 2696, 505, 8, 126, "Code"],
Cell[134912, 2706, 1141, 23, 331, "Code"],
Cell[136056, 2731, 618, 10, 126, "Code"],
Cell[136677, 2743, 1109, 23, 331, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137823, 2771, 100, 1, 258, "Section"],
Cell[137926, 2774, 106, 2, 126, "Code"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
